<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Label potential SWR events</title>
  <link rel="stylesheet" href="lib/bootstrap.min.css">
  <link rel="stylesheet" href="lib/vue-loading.min.css">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Attributes with the prefix "v-" are
       parsed by the JavaScript UI framework "Vue".
       See: https://vuejs.org
  -->
  <div id="label-app" class="container">

    <loading v-bind:active.sync="loading"></loading>

    <nav class="navbar navbar-light bg-light">
      <div class="d-flex">
        <button class="btn btn-outline-secondary mr-4"
                data-toggle="modal"
                data-target="#instructions">
          Instructions
        </button>
        <form class="form-inline">
          <label for="subset-selector"
                 class="navbar-text mr-2">
            Subset of events:
          </label>
          <select v-model="selected_subset"
                  id="subset-selector"
                  class="form-control"
                  title="Select the subset of events that are loaded">
            <option disabled value="">
              Select subset
            </option>
            <option v-for="s in subsets">
              {{ s }}
            </option>
          </select>
        </form>
      </div>
    </nav>

    <div class="row mt-3">
      <div class="col">
        <div class="card">
          <div id="vignette-container">
            <img v-for="event in events"
                 v-bind:src="imageSrc(event)"
                 v-on:mouseover="hovered = event"
                 v-on:mouseleave="hovered = null"
                 v-on:click="activate(event)"
                 v-bind:id="'vignette-' + event.id"
                 class="vignette mr-2"
                 v-bind:class="vignetteClass(event)"
                 v-bind:title="vignetteTitle(event)">
          </div>
        </div>
      </div>
    </div>

    <div class="row mt-3">
      <div class="col">
        <div id="context"
             class="card">
          <transition name="fade" mode="out-in">
            <img v-bind:src="contextSrc"
                 v-bind:key="contextSrc">
          </transition>
        </div>
      </div>
    </div>

    <div id="instructions"
         class="modal fade"
         tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Label potential SWR events</h5>
            <button type="button"
                    class="close"
                    data-dismiss="modal">
              <span>&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p class="text-muted">This dialog box can be reopened at any time by clicking 'Instructions'.</p>

            <p>Thanks for taking the time to help.</p>

            <h5>Workflow</h5>
            <!-- <p>First, select a set of events to label using the dropdown menu.</p> -->
            <ul class="pl-3">
              <li>Events are presented one by one, taken from the 'Unlabelled' queue at the top.</li>
              <li>Each event is represented by two voltage traces: one from an electrode in the pyramidal cell layer (the top trace), and one from an electrode in the stratum radiatum.</li>
              <li>Click one of the two blue 'Label' buttons (or use the left and right arrow keys) to classify the current event as either 'Probably <em>not</em> an SWR event', or 'Probably an SWR event'.</li>
            </ul>
            <p class="text-muted">If you think you have made a mistake, you can click one of the already labelled events at the bottom of the page to move it back to the decision area.</p>

            <h5>The plots</h5>
            <p>The event that is currently active can be seen in the middle left. The scalebars represent 50 ms and 1 mV.</p>
            <p>To the right, you can see a more comprehensive plot of the current event: all 16 channels are plotted (instead of only two), and the plot ranges from 1000 ms before to 1000 ms after the event.
            <p>In this large plot, the blue vertical line marks the currently active event. The grey vertical lines correspond to other detected events. The scalebar at the beginning of this plot represents 1 mV.</p>
          </div>
          <div class="modal-footer">
            <button type="button"
                    class="btn btn-primary"
                    data-dismiss="modal">
              Let's get started
            </button>
          </div>
        </div>
      </div>
    </div>

  </div>

  <script src="lib/jquery-3.3.1.min.js"></script>
  <script src="lib/bootstrap.bundle.min.js"></script>
  <script src="lib/moment.js"></script>
  <script src="lib/lodash.js"></script>
  <script src="lib/vue.js"></script>
  <script src="lib/vue-loading.min.js"></script>
  <script src="lib/vue-scrollto.js"></script>
  <script src="app.js"></script>
</body>
</html>
